package tracetest

import (
	"encoding/json"
	"fmt"
	"testing"
)

func TestTxn(t *testing.T) {
	debugTraceTransactionResultJson := `
	{
		"jsonrpc": "2.0",
		"id": 0,
		"result": {
		  "from": "0x7351d784e1470af4983c3cd680d795e3be815dc5",
		  "gas": "0xbeb69",
		  "gasUsed": "0x8623a",
		  "to": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
		  "input": "0x1cff79cd00000000000000000000000082ecd135dce65fbc6dbdd0e4237e0af93ffd503800000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000104db802a320000000000000000000000005ef30b9986345249bc32d8928b7ee64de9435e3900000000000000000000000019c0976f590d67707e62397c87829d896dc0f1f1000000000000000000000000bf72da2bd84c5170618fbe5914b0eca9638d5eb50000000000000000000000009759a6ac90977b93b58547b4a71c78317f391a28574254432d4100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005f688580000000000000000000000000000000000000000000001969368974c05b00000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000",
		  "output": "0x00000000000000000000000000000000000000000000000000000000000076d2",
		  "calls": [
			{
			  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
			  "gas": "0xb8e00",
			  "gasUsed": "0x91ecc",
			  "to": "0x82ecd135dce65fbc6dbdd0e4237e0af93ffd5038",
			  "input": "0xdb802a320000000000000000000000005ef30b9986345249bc32d8928b7ee64de9435e3900000000000000000000000019c0976f590d67707e62397c87829d896dc0f1f1000000000000000000000000bf72da2bd84c5170618fbe5914b0eca9638d5eb50000000000000000000000009759a6ac90977b93b58547b4a71c78317f391a28574254432d4100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005f688580000000000000000000000000000000000000000000001969368974c05b000000000000000000000000000000000000000000000000000000000000000000001",
			  "output": "0x00000000000000000000000000000000000000000000000000000000000076d2",
			  "calls": [
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0xb52db",
				  "gasUsed": "0x34212",
				  "to": "0x5ef30b9986345249bc32d8928b7ee64de9435e39",
				  "input": "0x6090dec5574254432d410000000000000000000000000000000000000000000000000000000000000000000000000000d4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "output": "0x00000000000000000000000000000000000000000000000000000000000076d2",
				  "calls": [
					{
					  "from": "0x5ef30b9986345249bc32d8928b7ee64de9435e39",
					  "gas": "0xa8c79",
					  "gasUsed": "0xa597",
					  "to": "0x9da9506f155c8aa57ab67fcb21484f19df18f7f5",
					  "input": "0x6080604052348015600f57600080fd5b5060405161012438038061012483398181016040526020811015603157600080fd5b81019080805190602001909291905050508073ffffffffffffffffffffffffffffffffffffffff1663a3b22fc4336040518263ffffffff1660e01b8152600401808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001915050600060405180830381600087803b15801560c057600080fd5b505af115801560d3573d6000803e3d6000fd5b5050505050603e806100e66000396000f3fe6080604052600080fdfea265627a7a7231582011d8228e4d52a33e72559199f2a9e6502500acb18f172cf552c647d56fee044f64736f6c634300050c003200000000000000000000000035d1b3f3d7966a1dfe207aa4514c12a259a0492b",
					  "output": "0x6080604052600080fdfea265627a7a7231582011d8228e4d52a33e72559199f2a9e6502500acb18f172cf552c647d56fee044f64736f6c634300050c0032",
					  "calls": [
						{
						  "from": "0x9da9506f155c8aa57ab67fcb21484f19df18f7f5",
						  "gas": "0xa56b5",
						  "gasUsed": "0x692c",
						  "to": "0x35d1b3f3d7966a1dfe207aa4514c12a259a0492b",
						  "input": "0xa3b22fc40000000000000000000000005ef30b9986345249bc32d8928b7ee64de9435e39",
						  "value": "0x0",
						  "type": "CALL"
						}
					  ],
					  "value": "0x0",
					  "type": "CREATE"
					}
				  ],
				  "value": "0x0",
				  "type": "CALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x81bfa",
				  "gasUsed": "0x264",
				  "to": "0x5ef30b9986345249bc32d8928b7ee64de9435e39",
				  "input": "0x2726b07300000000000000000000000000000000000000000000000000000000000076d2",
				  "output": "0x0000000000000000000000009da9506f155c8aa57ab67fcb21484f19df18f7f5",
				  "type": "STATICCALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x81803",
				  "gasUsed": "0x18e",
				  "to": "0x5ef30b9986345249bc32d8928b7ee64de9435e39",
				  "input": "0x36569e77",
				  "output": "0x00000000000000000000000035d1b3f3d7966a1dfe207aa4514c12a259a0492b",
				  "type": "STATICCALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x814cd",
				  "gasUsed": "0x1e6",
				  "to": "0x5ef30b9986345249bc32d8928b7ee64de9435e39",
				  "input": "0x2c2cb9fd00000000000000000000000000000000000000000000000000000000000076d2",
				  "output": "0x574254432d410000000000000000000000000000000000000000000000000000",
				  "type": "STATICCALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x807a5",
				  "gasUsed": "0x98a",
				  "to": "0xbf72da2bd84c5170618fbe5914b0eca9638d5eb5",
				  "input": "0x7bd2bea7",
				  "output": "0x0000000000000000000000002260fac5e5542a773aa44fbcfedf7c193bc2c599",
				  "value": "0x0",
				  "type": "CALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x7f2dd",
				  "gasUsed": "0x9646",
				  "to": "0x2260fac5e5542a773aa44fbcfedf7c193bc2c599",
				  "input": "0x23b872dd0000000000000000000000007351d784e1470af4983c3cd680d795e3be815dc5000000000000000000000000d4c41aa84a217a5ba95c5a1059cb6e5f4caa09d40000000000000000000000000000000000000000000000000000000005f68858",
				  "output": "0x0000000000000000000000000000000000000000000000000000000000000001",
				  "value": "0x0",
				  "type": "CALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x75d9c",
				  "gasUsed": "0x1ba",
				  "to": "0xbf72da2bd84c5170618fbe5914b0eca9638d5eb5",
				  "input": "0x7bd2bea7",
				  "output": "0x0000000000000000000000002260fac5e5542a773aa44fbcfedf7c193bc2c599",
				  "value": "0x0",
				  "type": "CALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x75a2b",
				  "gasUsed": "0x6094",
				  "to": "0x2260fac5e5542a773aa44fbcfedf7c193bc2c599",
				  "input": "0x095ea7b3000000000000000000000000bf72da2bd84c5170618fbe5914b0eca9638d5eb50000000000000000000000000000000000000000000000000000000005f68858",
				  "output": "0x0000000000000000000000000000000000000000000000000000000000000001",
				  "value": "0x0",
				  "type": "CALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x6f972",
				  "gasUsed": "0xd18d",
				  "to": "0xbf72da2bd84c5170618fbe5914b0eca9638d5eb5",
				  "input": "0x3b4da69f0000000000000000000000009da9506f155c8aa57ab67fcb21484f19df18f7f50000000000000000000000000000000000000000000000000000000005f68858",
				  "calls": [
					{
					  "from": "0xbf72da2bd84c5170618fbe5914b0eca9638d5eb5",
					  "gas": "0x6b988",
					  "gasUsed": "0x732c",
					  "to": "0x35d1b3f3d7966a1dfe207aa4514c12a259a0492b",
					  "input": "0x7cdd3fde574254432d4100000000000000000000000000000000000000000000000000000000000000000000000000009da9506f155c8aa57ab67fcb21484f19df18f7f50000000000000000000000000000000000000000000000000de23c544d366000",
					  "value": "0x0",
					  "type": "CALL"
					},
					{
					  "from": "0xbf72da2bd84c5170618fbe5914b0eca9638d5eb5",
					  "gas": "0x64602",
					  "gasUsed": "0x262a",
					  "to": "0x2260fac5e5542a773aa44fbcfedf7c193bc2c599",
					  "input": "0x23b872dd000000000000000000000000d4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4000000000000000000000000bf72da2bd84c5170618fbe5914b0eca9638d5eb50000000000000000000000000000000000000000000000000000000005f68858",
					  "output": "0x0000000000000000000000000000000000000000000000000000000000000001",
					  "value": "0x0",
					  "type": "CALL"
					}
				  ],
				  "value": "0x0",
				  "type": "CALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x6299e",
				  "gasUsed": "0x15d",
				  "to": "0xbf72da2bd84c5170618fbe5914b0eca9638d5eb5",
				  "input": "0xb3bcfa82",
				  "output": "0x0000000000000000000000000000000000000000000000000000000000000008",
				  "value": "0x0",
				  "type": "CALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x61be9",
				  "gasUsed": "0xe3b4",
				  "to": "0x19c0976f590d67707e62397c87829d896dc0f1f1",
				  "input": "0x44e2a5a8574254432d410000000000000000000000000000000000000000000000000000",
				  "output": "0x00000000000000000000000000000000000000000381206843937b66075bab0f",
				  "calls": [
					{
					  "from": "0x19c0976f590d67707e62397c87829d896dc0f1f1",
					  "gas": "0x5f044",
					  "gasUsed": "0x2b56",
					  "to": "0x35d1b3f3d7966a1dfe207aa4514c12a259a0492b",
					  "input": "0xd9638d36574254432d410000000000000000000000000000000000000000000000000000",
					  "output": "0x0000000000000000000000000000000000000000001a3e77718a51f0fb1ab8a40000000000000000000000000000000000000000038107e3cfbfa845898f135800000000000000000000000000000000000000f462823a6c0879b1bfac69ee58000000000000000000008faff79bbb02c61b50e76ac87cf244b44c8a9ea99db000000000000000000000000521b7a1a5eafae3c9684d30c63a67800000000000",
					  "value": "0x0",
					  "type": "CALL"
					},
					{
					  "from": "0x19c0976f590d67707e62397c87829d896dc0f1f1",
					  "gas": "0x598bf",
					  "gasUsed": "0x5a46",
					  "to": "0x35d1b3f3d7966a1dfe207aa4514c12a259a0492b",
					  "input": "0xb65337df574254432d410000000000000000000000000000000000000000000000000000000000000000000000000000a950524441892a31ebddf91d3ceefa04bf45446600000000000000000000000000000000000000000000188473d3d3207dcc97b7",
					  "value": "0x0",
					  "type": "CALL"
					}
				  ],
				  "value": "0x0",
				  "type": "CALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x53a0c",
				  "gasUsed": "0x9e8",
				  "to": "0x35d1b3f3d7966a1dfe207aa4514c12a259a0492b",
				  "input": "0x6c25b3460000000000000000000000009da9506f155c8aa57ab67fcb21484f19df18f7f5",
				  "output": "0x0000000000000000000000000000000000000000000000000000000000000000",
				  "type": "STATICCALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x52b7e",
				  "gasUsed": "0x153b8",
				  "to": "0x5ef30b9986345249bc32d8928b7ee64de9435e39",
				  "input": "0x45e6bdcd00000000000000000000000000000000000000000000000000000000000076d20000000000000000000000000000000000000000000000000de23c544d366000000000000000000000000000000000000000000000000176e05f03b102d04757",
				  "calls": [
					{
					  "from": "0x5ef30b9986345249bc32d8928b7ee64de9435e39",
					  "gas": "0x51087",
					  "gasUsed": "0x13c3d",
					  "to": "0x35d1b3f3d7966a1dfe207aa4514c12a259a0492b",
					  "input": "0x76088703574254432d4100000000000000000000000000000000000000000000000000000000000000000000000000009da9506f155c8aa57ab67fcb21484f19df18f7f50000000000000000000000009da9506f155c8aa57ab67fcb21484f19df18f7f50000000000000000000000009da9506f155c8aa57ab67fcb21484f19df18f7f50000000000000000000000000000000000000000000000000de23c544d366000000000000000000000000000000000000000000000000176e05f03b102d04757",
					  "value": "0x0",
					  "type": "CALL"
					}
				  ],
				  "value": "0x0",
				  "type": "CALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x3da97",
				  "gasUsed": "0x83ad",
				  "to": "0x5ef30b9986345249bc32d8928b7ee64de9435e39",
				  "input": "0xf9f30db600000000000000000000000000000000000000000000000000000000000076d2000000000000000000000000d4c41aa84a217a5ba95c5a1059cb6e5f4caa09d400000000000000000000000521b7a1a5eafae3c9684d30c63a67800000000000",
				  "calls": [
					{
					  "from": "0x5ef30b9986345249bc32d8928b7ee64de9435e39",
					  "gas": "0x3c5d3",
					  "gasUsed": "0x6d27",
					  "to": "0x35d1b3f3d7966a1dfe207aa4514c12a259a0492b",
					  "input": "0xbb35783b0000000000000000000000009da9506f155c8aa57ab67fcb21484f19df18f7f5000000000000000000000000d4c41aa84a217a5ba95c5a1059cb6e5f4caa09d400000000000000000000000521b7a1a5eafae3c9684d30c63a67800000000000",
					  "value": "0x0",
					  "type": "CALL"
					}
				  ],
				  "value": "0x0",
				  "type": "CALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x35758",
				  "gasUsed": "0xa35",
				  "to": "0x35d1b3f3d7966a1dfe207aa4514c12a259a0492b",
				  "input": "0x4538c4eb000000000000000000000000d4c41aa84a217a5ba95c5a1059cb6e5f4caa09d40000000000000000000000009759a6ac90977b93b58547b4a71c78317f391a28",
				  "output": "0x0000000000000000000000000000000000000000000000000000000000000001",
				  "type": "STATICCALL"
				},
				{
				  "from": "0xd4c41aa84a217a5ba95c5a1059cb6e5f4caa09d4",
				  "gas": "0x341f0",
				  "gasUsed": "0xdf71",
				  "to": "0x9759a6ac90977b93b58547b4a71c78317f391a28",
				  "input": "0xef693bed0000000000000000000000007351d784e1470af4983c3cd680d795e3be815dc50000000000000000000000000000000000000000000001969368974c05b00000",
				  "calls": [
					{
					  "from": "0x9759a6ac90977b93b58547b4a71c78317f391a28",
					  "gas": "0x3213f",
					  "gasUsed": "0x2a5b",
					  "to": "0x35d1b3f3d7966a1dfe207aa4514c12a259a0492b",
					  "input": "0xbb35783b000000000000000000000000d4c41aa84a217a5ba95c5a1059cb6e5f4caa09d40000000000000000000000009759a6ac90977b93b58547b4a71c78317f391a2800000000000000000000000521b7a1a5eafae3c9684d30c63a67800000000000",
					  "value": "0x0",
					  "type": "CALL"
					},
					{
					  "from": "0x9759a6ac90977b93b58547b4a71c78317f391a28",
					  "gas": "0x2e437",
					  "gasUsed": "0x7c65",
					  "to": "0x6b175474e89094c44da98b954eedeac495271d0f",
					  "input": "0x40c10f190000000000000000000000007351d784e1470af4983c3cd680d795e3be815dc50000000000000000000000000000000000000000000001969368974c05b00000",
					  "value": "0x0",
					  "type": "CALL"
					}
				  ],
				  "value": "0x0",
				  "type": "CALL"
				}
			  ],
			  "value": "0x0",
			  "type": "DELEGATECALL"
			}
		  ],
		  "value": "0x0",
		  "type": "CALL"
		}
	  }
	`
	_ = debugTraceTransactionResultJson
	result := UtilsFun{}
	_ = json.Unmarshal([]byte(debugTraceTransactionResultJson), &result)
	fmt.Printf("%+v\n", result)
}

type UtilsFun struct {
	Jsonrpc string         `json:"jsonrpc"`
	Id      int            `json:"id"`
	Result  UtilsFunResult `json:"result"`
}

type UtilsFunResult struct {
	From    string                `json:"from"`
	Gas     string                `json:"gas"`
	GasUsed string                `json:"gasUsed"`
	To      string                `json:"to"`
	Input   string                `json:"input"`
	Output  string                `json:"output"`
	Calls   []UtilsFunResultCalls `json:"calls"`
	Value   string                `json:"value"`
	Type    string                `json:"type"`
}

type UtilsFunResultCalls struct {
	From    string                `json:"from"`
	Gas     string                `json:"gas"`
	GasUsed string                `json:"gasUsed"`
	To      string                `json:"to"`
	Input   string                `json:"input"`
	Output  string                `json:"output"`
	Calls   []UtilsFunResultCalls `json:"calls"`
	Value   string                `json:"value"`
	Type    string                `json:"type"`
}
